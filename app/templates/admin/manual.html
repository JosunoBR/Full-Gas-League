{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="text-white fw-bold"><i class="fa-solid fa-book text-info"></i> Manual de Operações do Sistema</h2>
    <a href="{{ url_for('admin.dashboard') }}" class="btn btn-outline-secondary">Voltar ao Dashboard</a>
</div>

<div class="row">
    <div class="col-md-3 mb-4">
        <div class="list-group sticky-top" style="top: 20px; z-index: 1;">
            <a href="#intro" class="list-group-item list-group-item-action bg-dark text-white border-secondary active">Introdução</a>
            <a href="#season" class="list-group-item list-group-item-action bg-dark text-white border-secondary">1. Temporadas e Corridas</a>
            <a href="#results" class="list-group-item list-group-item-action bg-dark text-white border-secondary">2. Lançamento de Resultados</a>
            <a href="#tribunal" class="list-group-item list-group-item-action bg-dark text-white border-secondary">3. Tribunal e Punições</a>
            <a href="#pilots" class="list-group-item list-group-item-action bg-dark text-white border-secondary">4. Gestão de Pilotos</a>
        </div>
    </div>
    
    <div class="col-md-9">
        <!-- Intro -->
        <div id="intro" class="card bg-dark border-silver mb-4 shadow">
            <div class="card-body text-white">
                <h4 class="text-info fw-bold">Bem-vindo ao Painel Administrativo</h4>
                <p class="text-white-50 mb-0">Este guia explica como operar as funções vitais do sistema FullGas. O sistema foi desenhado para automatizar cálculos, então seu trabalho principal é <strong>inserir os dados corretamente</strong>.</p>
            </div>
        </div>

        <!-- Season -->
        <div id="season" class="card bg-dark border-silver mb-4 shadow">
            <div class="card-header border-secondary"><h5 class="text-white mb-0 fw-bold">1. Temporadas e Corridas</h5></div>
            <div class="card-body text-white">
                <p class="text-white-50">Tudo começa aqui. Você não consegue lançar resultados sem uma temporada ativa.</p>
                <ul class="text-white-50">
                    <li class="mb-2"><strong class="text-white">Criar Temporada:</strong> Vá em <em>Temporadas > Nova Temporada</em>. Apenas uma pode estar ativa por vez.</li>
                    <li class="mb-2"><strong class="text-white">Adicionar Corridas:</strong> Dentro da temporada, use o formulário para adicionar etapas. Defina corretamente o <strong>Grid</strong> (Elite/Advanced) e o <strong>Tipo</strong> (Normal/Sprint/Final) pois isso afeta a pontuação.</li>
                    <li class="mb-0"><strong class="text-white">Gerar Grid (Texto):</strong> Antes da corrida, você pode clicar no ícone de "Lista" na corrida para gerar o texto do grid com os carros (Lastro) já definidos para enviar no WhatsApp.</li>
                </ul>
            </div>
        </div>

        <!-- Results -->
        <div id="results" class="card bg-dark border-silver mb-4 shadow">
            <div class="card-header border-secondary"><h5 class="text-white mb-0 fw-bold">2. Lançamento de Resultados</h5></div>
            <div class="card-body text-white">
                <p class="text-white-50">Esta é a parte mais crítica. Ao clicar em "Resultados" na lista de corridas:</p>
                <h6 class="text-warning fw-bold">Pilotos Titulares</h6>
                <p class="small text-white-50">O sistema lista automaticamente quem é do grid. Marque a presença:</p>
                <ul class="small text-white-50">
                    <li><strong class="text-white">OK:</strong> Correu. Preencha a Posição.</li>
                    <li><strong class="text-white">FJ (Falta Justificada):</strong> Não correu, não perde pontos na CNH.</li>
                    <li><strong class="text-white">FNJ (Falta Não Justificada):</strong> O sistema descontará automaticamente 5 pontos da CNH.</li>
                </ul>
                
                <h6 class="text-warning fw-bold mt-3">Pilotos Reservas</h6>
                <p class="small text-white-50">Se alguém de fora correu, adicione na seção inferior. <strong>Importante:</strong> Você deve selecionar por qual Equipe ele correu para que os pontos de construtores sejam somados corretamente.</p>
                
                <div class="alert alert-secondary border-0 py-2 mt-3">
                    <i class="fa-solid fa-circle-exclamation me-2"></i> <strong>Atenção:</strong> Se precisar corrigir algo, basta editar os resultados novamente. O sistema recalcula tudo (inclusive punições de W.O.) automaticamente.
                </div>
            </div>
        </div>

        <!-- Tribunal -->
        <div id="tribunal" class="card bg-dark border-silver mb-4 shadow">
            <div class="card-header border-secondary"><h5 class="text-white mb-0 fw-bold">3. Tribunal</h5></div>
            <div class="card-body text-white">
                <p class="text-white-50">O fluxo de protestos é semi-automático:</p>
                <ol class="text-white-50">
                    <li>Piloto abre protesto.</li>
                    <li>Acusado envia defesa (status muda para <em>Em Votação</em>).</li>
                    <li>Admins votam.</li>
                    <li><strong>Super Admin</strong> encerra o caso escolhendo o Veredito Final.</li>
                </ol>
                <p class="text-white-50">Ao encerrar como <strong>Leve, Média ou Grave</strong>, o sistema desconta os pontos da CNH e da Corrida (se aplicável) na hora. Não precisa editar o perfil do piloto manualmente.</p>
            </div>
        </div>
        
        <!-- Pilots -->
        <div id="pilots" class="card bg-dark border-silver mb-4 shadow">
            <div class="card-header border-secondary"><h5 class="text-white mb-0 fw-bold">4. Gestão de Pilotos</h5></div>
            <div class="card-body text-white">
                <p class="text-white-50">Em <em>Pilotos > Editar</em>, você pode:</p>
                <ul class="text-white-50">
                    <li>Ajustar o Grid do piloto.</li>
                    <li>Alterar a Equipe (embora seja melhor fazer isso no menu Equipes).</li>
                    <li><strong>Resetar Senha:</strong> Se o piloto esquecer, você pode definir uma nova aqui.</li>
                    <li><strong>Ajuste Manual de CNH:</strong> Use com cuidado. O sistema já gerencia isso pelos protestos.</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}